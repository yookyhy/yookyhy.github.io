import{a as j,r as o,s as N,j as e}from"./index-pIZbQTh6.js";function b(t){console.log(t)}function w(){const{user:t}=j(),[d,r]=o.useState([]),[a,c]=o.useState(!1),[x,i]=o.useState(null),l=o.useMemo(()=>N.channel("test-channel").on("broadcast",{event:"shout"},s=>{b(s),i(s),r(n=>[...n,{...s,timestamp:new Date().toLocaleTimeString()}])}).on("broadcast",{event:"aa"},s=>{b(s),i(s),r(n=>[...n,{...s,timestamp:new Date().toLocaleTimeString()}])}),[]),h=o.useCallback(()=>{console.log(l),l&&(l.subscribe(),c(!0))},[l]),u=o.useCallback(()=>{console.log(l),l&&(l.unsubscribe(),c(!1))},[l]),m=o.useCallback(s=>{const n=`Hi from ${(t==null?void 0:t.email)||"Anonymous"}`;l.send({type:"broadcast",event:s||"shout",payload:{message:n,sender:(t==null?void 0:t.email)||"Anonymous"}}),r(p=>[...p,{payload:{message:n,sender:(t==null?void 0:t.email)||"Anonymous"},timestamp:new Date().toLocaleTimeString(),isLocal:!0}])},[l,t]),g=o.useCallback(()=>{r([]),i(null)},[]);return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-blue-50 p-4 font-noto",children:e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 mb-4",children:[e.jsx("h1",{className:"text-xl font-bold text-slate-800 mb-2",children:"🔴 실시간 채팅 테스트"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Supabase Realtime을 사용한 실시간 메시지 테스트"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 mb-4",children:[e.jsx("h2",{className:"text-base font-semibold text-slate-700 mb-3",children:"🎮 컨트롤 패널"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsx("button",{onClick:h,disabled:a,className:`
                                px-3 py-2 rounded-lg font-medium transition-all duration-200 text-sm
                                ${a?"bg-green-100 text-green-700 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white hover:shadow-lg"}
                            `,children:a?"✅ 구독됨":"📡 구독"}),e.jsx("button",{onClick:()=>m(),disabled:!a,className:`
                                px-3 py-2 rounded-lg font-medium transition-all duration-200 text-sm
                                ${a?"bg-orange-500 hover:bg-orange-600 text-white hover:shadow-lg":"bg-gray-100 text-gray-400 cursor-not-allowed"}
                            `,children:"📢 Shout"}),e.jsx("button",{onClick:()=>m("aa"),disabled:!a,className:`
                                px-3 py-2 rounded-lg font-medium transition-all duration-200 text-sm
                                ${a?"bg-purple-500 hover:bg-purple-600 text-white hover:shadow-lg":"bg-gray-100 text-gray-400 cursor-not-allowed"}
                            `,children:"🎯 AA"}),e.jsx("button",{onClick:u,disabled:!a,className:`
                                px-3 py-2 rounded-lg font-medium transition-all duration-200 text-sm
                                ${a?"bg-red-500 hover:bg-red-600 text-white hover:shadow-lg":"bg-gray-100 text-gray-400 cursor-not-allowed"}
                            `,children:"❌ 해제"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{onClick:g,className:"px-3 py-1.5 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors text-sm",children:"🗑️ 지우기"}),e.jsxs("div",{className:"px-3 py-1.5 bg-slate-100 rounded-lg",children:[e.jsx("span",{className:"text-xs text-slate-600",children:"상태: "}),e.jsx("span",{className:`font-medium text-xs ${a?"text-green-600":"text-red-600"}`,children:a?"연결됨":"연결 안됨"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 mb-4",children:[e.jsx("h2",{className:"text-base font-semibold text-slate-700 mb-3",children:"💬 메시지 로그"}),d.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx("div",{className:"text-3xl mb-2",children:"💭"}),e.jsx("p",{className:"text-sm",children:"아직 메시지가 없습니다."}),e.jsx("p",{className:"text-xs",children:"구독 후 메시지를 보내보세요!"})]}):e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:d.map((s,n)=>e.jsxs("div",{className:`
                                        p-2 rounded-lg border-l-4 text-xs
                                        ${s.isLocal?"bg-blue-50 border-blue-400":"bg-green-50 border-green-400"}
                                    `,children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:`font-medium ${s.isLocal?"text-blue-700":"text-green-700"}`,children:s.isLocal?"📤 보낸 메시지":"📥 받은 메시지"}),e.jsx("span",{className:"text-xs text-slate-500",children:s.timestamp})]}),e.jsxs("div",{className:"text-xs text-slate-700",children:[e.jsx("strong",{children:"발신자:"})," ",s.payload.sender||"Unknown"]}),e.jsxs("div",{className:"text-xs text-slate-700",children:[e.jsx("strong",{children:"메시지:"})," ",s.payload.message]})]},n))})]}),x&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsx("h2",{className:"text-base font-semibold text-slate-700 mb-3",children:"📨 최신 메시지"}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-3",children:e.jsx("pre",{className:"text-xs text-slate-700 whitespace-pre-wrap",children:JSON.stringify(x,null,2)})})]})]})})}export{w as TestPage};
