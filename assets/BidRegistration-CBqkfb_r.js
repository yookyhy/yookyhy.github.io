import{u as S,b as D,r as b,j as e,s as y}from"./index-mT-WyXZ5.js";function E(){const c=S(),j=D(),g=new URLSearchParams(j.search),i=g.get("menu"),v=g.get("type"),[a,d]=b.useState({type:v||"bidding",category:"",title:"",description:"",time_duration:"",schedule_info:"",start_price:"",deadline_at:"",status:"active"}),[s,p]=b.useState({}),[u,h]=b.useState(!1),_=[{value:"ë©˜í† ë§",label:"ë©˜í† ë§"},{value:"ìŠ¤í„°ë””",label:"ìŠ¤í„°ë””"},{value:"ì†Œëª¨ì„",label:"ì†Œëª¨ì„"}],N=[{value:"30ë¶„",label:"30ë¶„"},{value:"1ì‹œê°„",label:"1ì‹œê°„"},{value:"1ì‹œê°„ 30ë¶„",label:"1ì‹œê°„ 30ë¶„"},{value:"2ì‹œê°„",label:"2ì‹œê°„"},{value:"2ì‹œê°„ 30ë¶„",label:"2ì‹œê°„ 30ë¶„"},{value:"3ì‹œê°„",label:"3ì‹œê°„"},{value:"ê¸°íƒ€",label:"ê¸°íƒ€"}],m=(t,r)=>{switch(t){case"category":return r?"":"ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.";case"title":return r.trim()?r.trim().length>=5?"":"ì œëª©ì€ 5ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.":"ê±°ë˜ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.";case"time_duration":return r?"":"ê±°ë˜ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.";case"schedule_info":return r.trim()?"":"ì˜ˆìƒ ì¼ì •ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.";case"start_price":{const n=parseInt(r);return r&&n>0?"":"ì‹œì‘ ê°€ê²©ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”. (1 ì´ìƒì˜ ìˆ«ì)"}case"deadline_at":return r?new Date(r)>new Date?"":"ë§ˆê° ì‹œê°„ì€ í˜„ì¬ ì‹œê°„ë³´ë‹¤ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤.":"ë§ˆê° ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.";case"description":return"";default:return""}},l=t=>{const{name:r,value:n}=t.target;d(x=>({...x,[r]:n}));const o=m(r,n);p(x=>({...x,[r]:o}))},w=()=>{const t={};return Object.keys(a).forEach(r=>{if(r!=="type"&&r!=="status"&&r!=="description"){const n=m(r,a[r]);n&&(t[r]=n)}}),p(t),Object.keys(t).length===0},$=async t=>{if(t.preventDefault(),!!w()){h(!0);try{await C(a),alert("ì‹œê°„ ì…ì°°ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!"),c(i?`/bids?menu=${i}`:"/bids")}catch(r){console.error("Submit error:",r),alert("ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}finally{h(!1)}}},C=async t=>{const{data:r,error:n}=await y.auth.getUser();n&&(alert("ì‚¬ìš©ì ì •ë³´ ì˜¤ë¥˜"),c("/")),console.log(r);const{error:o}=await y.from("time_bids").insert({user_id:r.user.id,category:t.category,deadline_at:t.deadline_at,description:t.description,schedule_info:t.schedule_info,start_price:t.start_price,time_duration:t.time_duration,title:t.title,type:t.type,status:t.status});console.log(o)},f=()=>Object.keys(a).every(t=>t==="type"||t==="status"||t==="description"?!0:!m(t,a[t]))&&Object.entries(a).every(([t,r])=>t==="description"?!0:r.toString().trim());return e.jsxs("div",{className:"p-4 max-w-md mx-auto font-noto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"ì‹œê°„ ì…ì°° ë“±ë¡"}),e.jsx("button",{onClick:()=>c(i?`/bids?menu=${i}`:"/bids"),className:"w-8 h-8 flex items-center justify-center text-slate-500 hover:text-slate-700 hover:bg-slate-200 rounded-lg transition-colors bg-white border border-slate-200",children:"âœ•"})]}),e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ê±°ë˜ ìœ í˜•"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>d(t=>({...t,type:"bidding"})),className:`flex-1 px-4 py-2 rounded-lg text-sm font-medium ${a.type==="bidding"?"bg-sky-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"â° íŒë§¤ (ë¹„ë”©)"}),e.jsx("button",{type:"button",onClick:()=>d(t=>({...t,type:"reverse"})),className:`flex-1 px-4 py-2 rounded-lg text-sm font-medium ${a.type==="reverse"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"ğŸ’¸ êµ¬ë§¤ (ì—­ë¹„ë”©)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ì¹´í…Œê³ ë¦¬"}),e.jsxs("select",{name:"category",value:a.category,onChange:l,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${s.category?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"}),_.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),s.category&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.category})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ê±°ë˜ ì œëª©"}),e.jsx("input",{type:"text",name:"title",value:a.title,onChange:l,placeholder:"ì˜ˆ: React ì…ë¬¸ ë©˜í† ë§",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${s.title?"border-red-500":"border-gray-300"}`}),s.title&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ìƒì„¸ ì„¤ëª… (ì„ íƒì‚¬í•­)"}),e.jsx("textarea",{name:"description",value:a.description,onChange:l,placeholder:"ìƒì„¸í•œ ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.",rows:"3",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${s.description?"border-red-500":"border-gray-300"}`}),s.description&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ê±°ë˜ ì‹œê°„"}),e.jsxs("select",{name:"time_duration",value:a.time_duration,onChange:l,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${s.time_duration?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}),N.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),s.time_duration&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.time_duration})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ì˜ˆìƒ ì¼ì •"}),e.jsx("input",{type:"text",name:"schedule_info",value:a.schedule_info,onChange:l,placeholder:"ì˜ˆ: 7/4 19:00~22:00 ì‚¬ì´",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${s.schedule_info?"border-red-500":"border-gray-300"}`}),s.schedule_info&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.schedule_info})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ì‹œì‘ ê°€ê²© (ëª¨ë¨¼íŠ¸)"}),e.jsx("input",{type:"number",name:"start_price",value:a.start_price,onChange:l,placeholder:"ì˜ˆ: 5",min:"1",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${s.start_price?"border-red-500":"border-gray-300"}`}),s.start_price&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.start_price})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ì…ì°° ë§ˆê° ì‹œê°„"}),e.jsx("input",{type:"datetime-local",name:"deadline_at",value:a.deadline_at,onChange:l,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${s.deadline_at?"border-red-500":"border-gray-300"}`}),s.deadline_at&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.deadline_at})]}),e.jsx("button",{type:"submit",disabled:!f()||u,className:`w-full py-3 px-4 rounded-lg font-medium text-white ${f()&&!u?"bg-blue-500 hover:bg-blue-600":"bg-gray-300 cursor-not-allowed"}`,children:u?"ë“±ë¡ ì¤‘...":"ë“±ë¡í•˜ê¸°"})]})]})}export{E as default};
